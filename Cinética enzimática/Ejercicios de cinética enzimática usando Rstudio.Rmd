---
title: "Ejercicios de cinética enzimática"
author: "César Antonio Ponce-Diego"
date: "Julio 2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Ejercicios de cinética enzimática

El propósito de estos ejercicios es porporcionar códigos que permitan estudiar el comportamiento de las enzimas a través de la creación de gráficos y obtención de modelos lineales utilizando el método de Lineawever-Burk. 

### Problema 1. ¿La enzima sigue un comportamiento Michealiano?

Los datos siguientes muestran valores de concentración de un sustrato que se utilizó para medir la actividad de cierta enzima. Para cada una de las concentraciones se obtuvieron diferentes velocidades, tal como se muestra abajo:

```{r enzima}
#Valores de concentración: 0.1, 0.5, 1.0. Creamos un vector llamadado "vec" con dichos datos:
conc <- c(0.1, 0.5, 1, 2)

#Las velocidades fueron las siguientes, contenidas en el vector "vel":
vel <- c(3, 50, 85, 100)

#Se crea un dataframe con los vectores como columna:
enzima <- data.frame("Concentración" = conc, "Actividad enzimática" = vel)
```

#### Gráfico de una enzima con cinética Michaeliana

Realizamos un gráfico con la paquetería "ggplot2" para observar el comportamiento de la enzima.

```{r, dpi=350}
#Cargamos la  paquetería ggplot2
library(ggplot2)

#Código para el gráfico. Nota que en la función scale_x_continuos puedes colocar tanto números como texto, sirve para modificar tus ejes.
ggplot(enzima, aes(x = Concentración, y = Actividad.enzimática)) +
  theme_bw() +
  labs(x = "Concentración de sustrato (mM)",
       y = "Actividad enzimática (µmol/min)") + 
  ggtitle("Medición de la actividad enzimática") +
  geom_point(size = 2.5, color = "darkblue") + 
  geom_line(lty = 5, size = 0.5) +
  theme(plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
        axis.title = element_text(size = 12, face = "bold")) +
  scale_y_continuous(breaks = seq(0, 100, by = 10)) + 
  scale_x_continuous(labels = c(0.1, 0.5, 1.0, 2.0, "Elevada"))
```

#### Conclusión: la enzima sigue una cinética de Michaelis-Menten.


### Problema 1. ¿Cuáles son los valores de la Vmax y Km de una enzima?

En este problema se busca estudiar los parámetros cinéticos de la enzima glutamato deshidrogenasa. Calcularemos dichos parámetros:

```{r}
#Los datos de concentración de L-glutamato son los siguientes:

glu <- c(1.68, 3.33, 5, 6.67, 10, 20)

#Los valores de velocidad obtenidos para dichas concentraciones son:

vel_in <- c(0.172,0.250, 0.286,0.303,0.334,0.384)

#Se crea un dataframe, con los valores iniciales y el reciproco de cada uno de ellos:

L_glutamato <- data.frame(glu, vel_in, "glu_reciproco" = 1/glu, 
                          "vel_reciproco" = 1/vel_in)
```

#### Gráfico de Michaelis-Mentes para la glutamato deshidrogenasa

```{r,dpi=350}
#Cargar paquetería "ggrepel", esta sirve para destacar puntos de interés:

library(ggrepel)

#Código propuesto para el gráfico:

ggplot(L_glutamato, aes(x = glu, y = vel_in)) + 
  theme_bw() +
  labs(x = "Concentración de L-glutamato (mM)",
       y = "Velocidad inicial (mM/min)") + 
  ggtitle("Actividad enzimática de la Glutamato deshidrogenasa") +
  theme(plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
        axis.title = element_text(size = 12, face = "bold")) +
  scale_y_continuous(breaks = seq(0, 0.45, by = 0.03)) +
  geom_line(lty = 5, size = 0.5) +
  geom_point(size = 2.5, color = "darkblue") + 
  geom_hline(yintercept = c((0.384/2), 0.384), , lty = 5) + 
  geom_vline(xintercept = c(2.10, 20), lty = 5) + 
  geom_text_repel(data = subset(L_glutamato, vel_in == 0.384 & glu == 20), 
                  aes(label = vel_in), size = 4,
                  box.padding = unit(1.5, "lines")) +
  geom_point(data = subset(L_glutamato, vel_in == 0.384 & glu == 20, 
                           color = "red"), size = 2.5) + 
  geom_text(aes(label = "")) + 
  annotate("text", label = "Km = 2.10", x = 4.4, y = 0.18, size = 4.5, 
    colour = "darkblue")
```

Ahora, con dichos datos, obtengamos los reciprocos para el gráfico de Lineawever-Burk. Basta con realizar una división sobre los datos de los ejes "y" y "x", es decir, 1/x y 1/y. Primero, debemos obtener los valores de la regresión lineal, para ello, R genera dichos valores utilizando la función "lm()".

```{r}
#Guardamos la información en una variable llamada "regresion" y aplicamos la función "summary" para obtener los valores de la pendiente y de la intersección con el eje.

regresion <- lm(data = L_glutamato, vel_reciproco ~ glu_reciproco)
summary(regresion)

```

Los parámetros de la ecuación vienen dados por la columna llamada "Estimate", en la parate de "Coefficients". El valos de la pendiente en este caso es 5.7477 y de la ordenada es 2.3647. 

```{r, dpi = 350}
#Código del gráfico:

ggplot(L_glutamato, aes(x = 1/glu, y = 1/vel_in)) + 
  theme_bw() +
  labs(x = "Concentración de L-glutamato (mM)",
       y = "Velocidad inicial (mM/min)") + 
  ggtitle("Actividad enzimática de la Glutamato deshidrogenasa") +
  theme(plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
        axis.title = element_text(size = 12, face = "bold")) +
  scale_y_continuous(breaks = seq(0, 6.5, by = 0.5)) +
  scale_x_continuous(breaks = seq(0, 0.7, by = 0.05)) +
  geom_point(size = 2.5, color = "darkblue") + 
  geom_smooth(method = "lm", color = "darkred") + 
  geom_text(aes(label = "")) + 
  annotate("text", label = "y = 5.7477x + 2.3647", x = 0.20, y = 5.5, size = 5, 
           colour = "darkblue")

```

NOTA: aquí utilicé la función "annotate" para colocar la ecuación de la recta sobre el gráfico, los valors de "x" y "y" dentro de esa función sirven para indicarle a R dónde debe ir dicho texto.


### Problema 3. Cambios en la Km y Vmax por alteración metabólica en ratones

En este problema, se midió la actividad de la enzima glucocinasa, una enzima encargada de convertir la glucosa en glucosa-6-fosfato. Solo como parte del conocimiento, hay dos enzimas encargadas de llevar a cabo dicha reacción, la glucocinasa y la hexocinasa, la diferencia radica en la localización de cada una, la glucocinasa se encuentra en el hígado, la hexocinasa en todas las células.

Se tienen dos ratones de experimentación, uno control y otro con la alteración metabólica, y se midio la actividad de dicha enzima tomando muestras de sangre, el ensayo se llevó a cabo con diferentes concentraciones de glucosa (mM).

```{r}
#Los datos se encuentran guardados en los vectores siguientes:

glucosa <- c(1.0,2.0,3.6,5.4,10.8,14.85,20.25,27.0,32.4,36.45,38.25)
control <- c(13.3,24.0,38.0,48.0,67.0,76.0,85.0,92.0,97.0,98.0,98.5)
problema <- c(46.5,66.5,82.8,93.2,101.2,103.5,106.95,109.25,112.0,112.8,113.27)

#Creamos nuestro dataframe con los datos iniciales y con los reciprocos:

raton <- data.frame(glucosa, control, problema, "glucosa_reciproco" = 1/glucosa,
                    "control_reciproco" = 1/control,
                    "problema_reciproco" = 1/problema)

```

¿Cómo podemos saber qué está ocurriendo con le ratón al tener dicha alteración metabólica? La mejor forma es calcular los parámetros cinéticos Km y Vmax, y de sa forma, al conocer dichos valores para el ratón control y el problema, sabremos la alteración. La regresión para ambos casos es la siguiente:

```{r}
#Datos para el ratón control

regresion <- lm(data = raton, control_reciproco ~ glucosa_reciproco)
summary(regresion)

```

```{r}
#Datos para el ratón problema
regresion <- lm(data = raton, problema_reciproco ~ glucosa_reciproco)
summary(regresion)

```

```{r, dpi=350}

#Código del gráfico 1:

ggplot(raton, aes(x = 1/glucosa, y = 1/control)) + 
  theme_bw() +
  labs(x = "Concentración glucosa (mM)",
       y = "Actividad enzimática (U/mg)") + 
  ggtitle("Grupo control") +
  theme(plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
        axis.title = element_text(size = 12, face = "bold")) + 
  geom_point(size = 2.5, color = "darkblue") +
  scale_y_continuous(breaks = seq(0, 0.1, by = 0.01)) +
  scale_x_continuous(breaks = seq(0, 1.5, by = 0.09)) +
  geom_smooth(method = "lm", color = "darkred", lty = 5) +
  geom_text(aes(label = "")) +
  annotate("text", label = "y = 0.0666x + 0.0084\nR^2 = 0.9998", 
           x = 0.25, y = 0.06, size = 4, 
           colour = "darkblue")
```

Los datos gráficos son para le ratón control, se muestra de igual forma su ecuacuón de la recta. Ahora grafiquemos los datos para el ratón problema. 

```{r, dpi=350}

ggplot(raton, aes(x = 1/glucosa, y = 1/problema)) + 
  theme_bw() +
  labs(x = "Concentración glucosa (mM)",
       y = "Actividad enzimática (U/mg)") + 
  ggtitle("Grupo problema") +
  theme(plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
        axis.title = element_text(size = 12, face = "bold")) + 
  geom_point(size = 2.5, color = "darkblue") +
  scale_y_continuous(breaks = seq(0, 0.03, by = 0.001)) +
  scale_x_continuous(breaks = seq(0, 1.5, by = 0.09)) +
  geom_smooth(method = "lm", color = "darkred", lty = 5) +
  geom_text(aes(label = "")) +
  annotate("text", label = "y = 0.0129x + 0.0086\nR^2 = 0.9989", 
           x = 0.25, y = 0.018, size = 4, 
           colour = "darkblue")
```

Una vez que tenemos los gráficos y nuestras ecuaciones de la recta para cada caso, vamos a calcular los valores de Km y Vmax. Recuerda, como usamos los reciprocos, no se pueden obtener de forma directa de la ecuacuón. En este caso, la Vmax es igual a 1/ordenada, y la Km = m(Vmax) o Km = m(ordenada). 

```{r}
#Valor de la Vmax. Para obtener un valor más exacto, hay que usar el dato de la ordenada proporcionado por R, en este caso, lo extraemos como sigue:

lm(data = raton, control_reciproco ~ glucosa_reciproco)[[1]][1]

#Obtenemos el inverso la expresió y nos dará el valor de Vmax:

1/lm(data = raton, control_reciproco ~ glucosa_reciproco)[[1]][1]


```

```{r}
#Lo convertimos en algo más visible:

c("Vmax_control" = unname(1/lm(data = raton, control_reciproco ~ glucosa_reciproco)[[1]][1]))

```

Para el valor de la Km aplicamos algo parecido, por lo que tendríamos finalmente lo siguiente:

```{r}
#Necesitamos el valor de Vmax

Vmax_control <- c("Vmax_control" = unname(1/lm(data = raton, control_reciproco ~ glucosa_reciproco)[[1]][1]))

#Necesitamos el valor de la pendiente

pendiente_control <- c("pendiente" = lm(data = raton, control_reciproco ~ glucosa_reciproco)[[1]][2])

#Multiplicamos Vmax con pendiente y obteneomos la Km:

c("Km_control" = unname(Vmax_control*pendiente_control))

```

Como es lo mismo para el ratón problema, omitiremos los pasos y colocaremos los valores finales de Vmax y Km para cada caso (si quieres, intenta hacer lo mismo pero con el grupo problema, y obtendrás lo mismo).

```{r, echo=FALSE}

Vmax_problema <- c("Vmax_problema" = unname(1/lm(data = raton, problema_reciproco ~ glucosa_reciproco)[[1]][1]))

pendiente_problema <- c("pendiente" = lm(data = raton, problema_reciproco ~ glucosa_reciproco)[[1]][2])

Km_problema <- c("Km_problema" = unname(Vmax_problema*pendiente_problema))
Km_control <- c("Km_control" = unname(Vmax_control*pendiente_control))


df <- data.frame("Km" = c(Km_control, Km_problema), "Vmax" = c(Vmax_control, Vmax_problema))

df

```

#### Conclusión: el ratón podría presentar hipoglucemia, ya que al cambiar el valor de la Km, esto provoca que la afinidad de la glucocinasa sea mayor por sus sustrato, en este caso, la glucosa, alterando entonces las concetraciones de glucosa en sangre hacia valores menores de lo normal, provocando una hipoglucemia. 


### Problema 4. ¿Qué tipo de inhibición presenta un compuesto "C" en una enzima?

En este caso, tenemos un archivo de excel con los datos, se encuentra en la hoja 6 (sheet 6), con lo cual, debemos cargarlo desde nuestro directorio y especificar dicha hoja, ¿cómo lo hacemos? Debemos emplear la paquetería "readxl" y escribir lo siguiente:

```{r}

#Cargamos la paquetería

library(readxl)

#Especificamos el directorio, recuerda que es diferente en cada computadora, en mi caso, lo tengo en el escritorio. Esto para cargar un archivo de excel.

cinetica <- read_excel("C:/Users/Windows/Desktop/Datos_cinética_enzimática.xlsx", 
                       sheet = 4, skip = 1, col_names = TRUE)


```

En el caso anterior, la función "skip" evita que Rstudio lea el renglón 1, porque no es de nuestro interés, y "col_names" genera los nombres de las columnas según los títulos que nosotros hayamos colocado en el archivo de excel. Una vez con los datos cargados, debemos comenzar a trabajar. 

Utiliza la función head(cinetica) para ver cómo está estructurado el dataframe. Tenemos una columna con concentraciones de glucosa en mM, y dos columnas para la actividad enzimática, una control y otra para un compuesto denominado en el ejercicio como "C". Para hacer el código más fácil, puedo renombrar las columas:

```{r}

names(cinetica)[1] = "glucosa"
names(cinetica)[2] = "C"
names(cinetica)[3] = "Control"

```

Lo que ocurrió que que se renombraron las columnas del dataframe. En este caso, se asume una cinética de Michaelis-Menten, por lo que procedemos a realizar la regresión lineal para obtener la ecuación de la recta, recordando que tenemos que obtener los reciprocos de todas las columnas. La función "cbind" nos permite agregar columnas a un dataframe existente. 

```{r}

cinetica <- cbind(cinetica, "reciproco_glu" = 1/cinetica$glucosa, 
                  "reciproco_C" = 1/cinetica$C, 
                  "reciproco_control" = 1/cinetica$Control)
```

Realizamos la regresión de ambos casos. Recuerda, con la función "lm" y colocamos " la función "summary".

```{r}

summary(lm(data = cinetica, cinetica$reciproco_control ~ cinetica$reciproco_glu))
summary(lm(data = cinetica, cinetica$reciproco_C ~ cinetica$reciproco_glu))

```

Finalmente, lo que podemos hacer para ahorrar código, es graficar ambas líneas en un solo gráfico, utilizando el siguiente código:

```{r, dpi=350}

ggplot(cinetica, aes(x = 1/glucosa)) + 
  theme_bw() +
  labs(x = "Concentración glucosa (mM)",
       y = "Actividad enzimática (U/mg)") + 
  ggtitle("Efecto de un compuesto C") +
  theme(plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
        axis.title = element_text(size = 12, face = "bold")) + 
  geom_line(aes(y = 1/Control),size = 0.8, color = "darkblue") +
  geom_line(aes(y = 1/C), size = 0.8, color= "red") + 
  geom_text(aes(label = "", y = 1/C)) + 
  annotate("text", label = "Compuesto C\ny = 0.1903x + 0.0084\nR^2 = 0.9985", 
           x = 0.25, y = 0.12, size = 3.5, 
           colour = "red") + 
  annotate("text", label = "Control\ny = 0.0666x + 0.0084\nR^2 = 0.9998", 
           x = 0.85, y = 0.11, size = 3.5, 
           colour = "darkblue")

```

Calculamos el valor de la Vmax y Km para ambos casos y finalmente concluimos el tipo de inhibición. Utilizamos el código que ya habíamos empleado para su cálculo. 

```{r}

Vmax_control_1 <- c("Vmax_Control" = unname(1/lm(data = cinetica, cinetica$reciproco_control ~ cinetica$reciproco_glu)[[1]][1]))

pendiente_control_1 <- c("pendiente_Control" = lm(data = cinetica, cinetica$reciproco_control ~ cinetica$reciproco_glu)[[1]][2])


Vmax_C<- c("Vmax_C" = unname(1/lm(data = cinetica, cinetica$reciproco_C ~ cinetica$reciproco_glu)[[1]][1]))

pendiente_C <- c("pendiente_C" = lm(data = cinetica, cinetica$reciproco_C ~ cinetica$reciproco_glu)[[1]][2])

Km_C <- c("Km_C" = unname(Vmax_C*pendiente_C))
Km_control_1 <- c("Km_control" = unname(Vmax_control_1*pendiente_control_1))


df_1<- data.frame("Km" = c(Km_control_1, Km_C), "Vmax" = c(Vmax_control_1, Vmax_C))

df_1

```

#### Conclusión: el valor de Vmax no se encuentra alterado, pero el valor de la Km sí, con esto podríamos indicar que se trata de un inhibidor competitivo, ya que este tipo de compuestos se unen a la enzima libre, alterando unicamente la unión del sustrato, pero no alteran la velocidad máxima (Vmax) de las enzimas. 



# FIN. 
